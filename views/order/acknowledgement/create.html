<div class="createAcknowledgementPage" ng-init="showCustomers=false; show_upholstery=false;showCustom_item=false;" fade-in>
    
    
    <!--
        Forms
    -->
    <div class="products" data-modal data-ng-model="showProducts" data-ng-switch on="selection" data-ng-init="selection='upholstery'"> 
        <div class="title">Add a Product to the Acknowledgement</div>
        <div class="selector">
            <ul>
                <li data-ng-click="selection='upholstery'" data-ng-class="{'active':selection=='upholstery'}">Upholstery</li>
                <li data-ng-click="selection='table'" data-ng-class="{'active':selection=='table'}">Table</li>
                <li data-ng-click="selection='custom'" data-ng-class="{'active':selection=='custom'}">Custom</li>
            </ul>
        </div>
        
        <div class="details upholstery" data-ng-switch-default>
            <div data-search-bar data-ng-model="upholsteryQuery"></div>
            <div class="container">
                <div class="list">
                    <div class="row" data-ng-repeat="upholstery in upholsteryList| filter:upholsteryQuery" data-ng-click="addUpholstery(upholstery)">
                        <div class="cell image">
                            <img ng-src="{{upholstery.url}}"/>
                        </div>
                        <div class="cell">
                            {{upholstery.description}}
                        </div>
                    </div>
                </div>  
            </div>
                          
        </div>
        
        <div class="details upholstery" data-ng-switch-when="table">
            <div data-search-bar data-ng-model="tableQuery"></div>
            <div class="container">
                <div class="list">
                    <div class="row" data-ng-repeat="table in tableList| filter:tableQuery" data-ng-click="addTable(table)">
                        <div class="cell image">
                            <img ng-src="{{table.url}}"/>
                        </div>
                        <div class="cell">
                            {{table.description}}
                        </div>
                    </div>
                </div>  
            </div>
                          
        </div>
        <form class="details custom" name="form" novalidate ng-switch-when="custom">
                <table>
                    <tr class="description">
                        <td>Description</td>
                        <td><input type="text" ng-model="item.description" required /></td>
                    </tr>
                </table>
                <div class="image-controller">
                    <h2>Image Controls</h2>
                    <button data-ng-click="cropper.crop()">Crop</button>
                    <button data-ng-click="cropper.save()">Save</button>
                    <button data-ng-click="previewCustomImage(cropper.getImageAsURL())">Preview</button>
                    <table>
                        <tr>
                            <td>Width:</td>
                            <td>{{cropper.image.scaled_width | number:0}}px</td>
                        </tr>
                        <tr>
                            <td>Height:</td>
                            <td>{{cropper.image.scaled_height | number:0}}px</td>
                        </tr>
                        <tr>
                            <td>Scale:</td>
                            <td><input type="number" data-ng-model="cropper.scale" min="0" max="100">%</td>
                        </tr>
                    </table>
                </div>
                
                <div class="image-preview" file-cropper>
                </div>
                
                <div class="bottom_bar">
                    <button ng-disabled="form.$invalid" ng-click="addCustomItem(item, cropper.getImage()); item={};">Add Item</button>
                </div>
        </form>
        <div class="details quantity" data-ng-switch-when="quantity">
            <table>
                <tr>
                    <td>
                        Quantity: 
                    </td>
                    <td>
                        <input ng-model="ack.products[ack.products.length-1].quantity" required ng-pattern="/^\d+$/" />
                    </td>
                </tr>
            </table>
            <div class="bottom-bar">
                <button ng-click="setQuantity()">Set Quantity</button>
                
            </div>
        </div>
        <div class="details fabric" data-ng-switch-when="fabric">
            <search-bar data-ng-model="queryFabric"></search-bar>
            <div class="product_container">
                <div class="product" data-drop-on="ack.products[ack.products.length-1].fabric">
                    <div>{{ack.products[ack.products.length-1].description}}</div>
                    
                    <div class="fabric" ui-if="ack.products[ack.products.length-1].fabric">
                        Fabric:  {{ack.products[ack.products.length-1].fabric.description}}
                        <img ng-src="{{ack.products[ack.products.length-1].fabric.image_url}}" />
                    </div>
                    
                </div>
                <div class="pillow" ng-repeat="pillow in ack.products[ack.products.length-1].pillows" data-drop-on="pillow.fabric">
                    <div>{{pillow.type | beautify}} Pillow</div>
                    <div class="fabric">
                        Fabric: {{pillow.fabric.description}}
                        <img ng-src="{{pillow.fabric.image_url}}" />
                    </div>
                </div>
            </div>
            <div class="fabric_container">
                <ul class="list">
                    <li class="item" ng-repeat="fabric in fabricList | filter:queryFabric " data-drag-on="fabric">
                        <img ng-src="{{fabric.image_url}}" />
                        <div class="details">
                            Pattern: {{fabric.pattern}}
                            <br />
                            Color: {{fabric.color}}
                        </div>
                        
                    </li>
                </ul>
            </div>
            <div class="bottom-bar">
                <button ng-click="setFabric()">Set Fabrics</button>
            </div>
        </div>
    </div>
    
    
    <form name="remarksForm" novalidate class="remarks_modal" data-modal ng-model="showRemarks">
        <div class="title">Remarks</div>
        <textarea ng-model="ack.remarks" ></textarea>
        <div class="bottom_bar">
            <button ng-click="showRemarks=false">Submit</button>
        </div>
    </form>
    
    
    <form name="vatForm" class="vat_modal" novalidate data-modal ng-model="showVat">
        <div class="title">Vat</div>
        <input ng-model="ack.vat" required ng-pattern="/^\d{1,2}$/" /><span>%</span>
        <div class="bottom_bar">
            <button ng-disabled="vatForm.$invalid" ng-click="showVat=false">Submit</button>
        </div>
    </form>
    
    <form name="poForm" class="po_modal" novalidate data-modal ng-model="showPO">
        <div class="title">PO Number</div>
        <input ng-model="ack.po_id"  size="40"/>
        <div class="bottom_bar">
            <button ng-click="showPO=false">Submit</button>
        </div>
    </form>
    
    
    
    <form class="ack" name="form" ec-droppable="add()" novalidate>
        <!--
            Sidebar
        -->
        
        <div class="sidebar">
            <header>
                <h1>
                    <span>Contacts</span>
                </h1>
            </header>
            <nav>
                <ul class="list">
                    <li><div ng-click="create()" >Create</div></li>
                    <li><div class="customer" checkmark="ack.customer" x="!ack.customer" ng-click="showCustomers=!showCustomers">Add Customer</div></li>
                    <li><div class="upholstery" checkmark="ack.products.length>0" x="ack.products.length==0" ng-click="showProducts=true">Add Product</div></li>
                   
                    <li><div class="delivery_date" checkmark="ack.delivery_date" x="!ack.delivery_date" ng-click="show_calendar=true">Set Delivery Date</div></li>
                    <li><div class="vat" checkmark="ack.vat" x="!ack.vat" ng-click="showVat=true">Set Vat</div></li>
                    <li><div class="po" checkmark="ack.po_id" x="!ack.po_id" ng-click="showPO=true">Set Purchase Order</div></li>
                    <li><div ng-click="showRemarks=true">Add Remarks</div></li>
                    <li><div ng-click="reset()" >Reset</div></li>
                </ul>
            </nav>
            
        </div>
        
        <!--
            Panels
        -->
        
        <div class="customer-modal" data-modal ng-model="showCustomers">
            <div class="title">
                Customers
            </div>
            <div class="container">
                <search-bar data-ng-model="queryCustomer"></search-bar>
                <ul class="list">
                    <li class="item" ng-click="addCustomer(customer)" ng-repeat="customer in customerList | filter:queryCustomer | orderBy:'name'">{{customer.name}}</li>
                </ul>
            </div>
            
        </div>
        
        
        
        
        
        <div class="calendar_modal" data-modal  ng-model="show_calendar">
            <div ui-date ng-model="ack.delivery_date">
            </div>
            <div class="bottom_bar">
                <button ng-disabled="!ack.delivery_date" ng-click="show_calendar=!show_calendar">Select</button>
            </div>
            
        </div>
        
        <!--
            Workspace
        -->
        <div class="workspace">
                
                <div class="customer">
                    <span class="title">Customer</span>
                    <table class="details">
                        <tr>
                            <td>Name:</td>
                            <td>{{ack.customer.name}}</td>
                        <tr>
                            <td>Address:</td>
                            <td>
                                {{ack.customer.addresses[0].address1}}
                                <br />
                                {{ack.customer.addresses[0].city}}, {{ack.customer.addresses[0].territory}}
                                <br />
                                {{ack.customer.addresses[0].territory}}, {{ack.customer.addresses[0].country}} {{ack.customer.addresses[0].zipcode}}
                            </td>
                        </tr>
                        <tr>
                            <td>Telephone:</td>
                            <td>{{ack.customer.telephone}}</td>
                        </tr>
                        <tr>
                            <td>Email:</td>
                            <td>{{ack.customer.email}}</td>
                        </tr>
                    </table>
                </div>
                
                <div class="order">
                    <table class="details">
                        <tr>
                            <td>Delivery Date:</td>
                            <td>{{ack.delivery_date | date:"MMMM d, yyyy"}}</td>
                        </tr>
                        <tr ui-if="ack.po_id">
                            <td>PO#:</td>
                            <td>{{ack.po_id}}</td>
                        </tr>
        
                        <tr>
                            <td>Vat:</td>
                            <td>{{ack.vat}}%</td>
                        </tr>
                        <tr>
                            <td>Currency:</td>
                            <td>
                                {{ack.customer.currency}}
                            </td>
                        </tr>
                    </table>
                </div>
                
            
            <div class="products" ng-show="ack.products.length>0">
                <div class="title">Products</div>
                <div class="product" ng-repeat="product in ack.products">
                    {{product.description}}
                    <table class="details">
                        <tr>
                            <td>Qty:</td>
                            <td>{{product.quantity}}</td>
                        </tr>
                        <tr>
                            <td>Custom Price</td>
                            <td><input type="text" data-ng-model="product.custom_price" /></td>
                        </tr>
                        <tr>
                            <td>Custom Size:</td>
                            <td><input type="checkbox" ng-model="product.is_custom_size" /></td>
                        </tr>
                        <tr>
                            <td>Width:</td>
                            <td><input type="text" ng-class="{'active':product.is_custom_size}" ng-disabled="!product.is_custom_size" ng-model="product.width" />mm</td>
                        </tr>
                        <tr>
                            <td>Depth:</td>
                            <td><input type="text" ng-class="{'active':product.is_custom_size}" ng-disabled="!product.is_custom_size" ng-model="product.depth" />mm</td>
                        </tr>
                        <tr>
                            <td>Height:</td>
                            <td><input type="text" ng-class="{'active':product.is_custom_size}" ng-disabled="!product.is_custom_size" ng-model="product.height" />mm</td>
                        </tr>
                        <tr ui-if="product.fabric">
                            <td>Fabric: </td>
                            <td>
                                {{product.fabric.description}}
                                <img ng-src="{{product.fabric.image_url}}" />
                            </td>
                            <td>
                                
                            </td>
                            
                        </tr>
                        <tr ng-repeat="pillow in product.pillows">
                            <td>{{pillow.type | beautify}} Pillow</td>
                            <td>{{pillow.fabric.description}}<img ng-src="{{pillow.fabric.image_url}}" /></td>
                        </tr>
                        <tr>
                            <td>Comments:</td>
                            <td><textarea cols="40" rows="4" ng-model="product.comments" ec-blur="tempSave()"></textarea></td>
                        </tr>
                    </table>
                    <img ng-src="{{product.image.url}}" />
                    <div class="remove_btn" ng-click="removeProduct($index)">Remove</div>
                </div>
                
                
            </div>
        </div>
    </form>
    
</div>